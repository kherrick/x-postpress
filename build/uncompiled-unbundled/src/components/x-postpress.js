import{getPosts,getPostsUrl}from"../utilities/misc.js";import{LitElement,html}from"/node_modules/lit-element/lit-element.js";import articles,{getErrorMessageArticle,loading}from"../templates/articles/articles.js";import styles from"../templates/styles/x-postpress.js";const xPostpress=class extends LitElement{static get properties(){const reflectedStringProp={type:String,reflect:!0};return{apiHost:reflectedStringProp,apiPath:reflectedStringProp,categories:reflectedStringProp,include:reflectedStringProp,page:reflectedStringProp,per_page:reflectedStringProp,search:reflectedStringProp,slug:reflectedStringProp,tags:reflectedStringProp,didGetPosts:{type:Boolean},articles:{type:Array}}}constructor(){super();this.urlAttributes=["apiHost","apiPath"];this.builtQueryStringAttributes=["categories","include","page","per_page","search","slug","tags"];this.didGetPosts=!1;this.articles=loading;this.apiHost="https://content.example.com";this.apiPath="/wp-json/wp/v2";this.categories="";this.include="";this.page="";this.per_page="";this.tags="";this.search="";this.slug=""}requestPosts(){const postsUrl=getPostsUrl({apiHost:this.apiHost,apiPath:this.apiPath,categories:this.categories,include:this.include,page:this.page,per_page:this.per_page,search:this.search,slug:this.slug,tags:this.tags},this.builtQueryStringAttributes);getPosts(postsUrl).then(res=>articles(res)).catch(err=>[getErrorMessageArticle(err,postsUrl)]).then(articles=>{this.didGetPosts=!0;this.articles=articles})}firstUpdated(){this.requestPosts()}updated(changedProperties){if(this.didGetPosts){const shouldGetPostsAttributes=[...this.urlAttributes,...this.builtQueryStringAttributes],props=changedProperties.keys();let prop=props.next();while(!prop.done){if(-1!==shouldGetPostsAttributes.indexOf(prop.value)){this.requestPosts();break}prop=props.next()}}}render(){return html`
      ${styles}<slot name="articles"></slot>${this.articles}
    `}};window.customElements.define("x-postpress",xPostpress);