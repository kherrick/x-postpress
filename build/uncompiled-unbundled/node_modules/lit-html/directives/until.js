import{isPrimitive}from"../lib/parts.js";import{directive}from"../lit-html.js";const _state=new WeakMap;export const until=directive((...args)=>part=>{let state=_state.get(part);if(state===void 0){state={values:[]};_state.set(part,state)}const previousValues=state.values;state.values=args;for(let i=0;i<args.length;i++){if(state.lastRenderedIndex!==void 0&&i>state.lastRenderedIndex){break}const value=args[i];if(isPrimitive(value)||"function"!==typeof value.then){part.setValue(value);state.lastRenderedIndex=i;break}if(state.lastRenderedIndex!==void 0&&"function"===typeof value.then&&value===previousValues[i]){continue}state.lastRenderedIndex=void 0;Promise.resolve(value).then(resolvedValue=>{const index=state.values.indexOf(value);if(-1<index&&(state.lastRenderedIndex===void 0||index<state.lastRenderedIndex)){state.lastRenderedIndex=index;part.setValue(resolvedValue);part.commit()}})}});